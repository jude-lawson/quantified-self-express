{"version":3,"sources":["../../src/models/MealFood.js"],"names":["environment","process","env","NODE_ENV","configuration","require","database","MealFood","meal_id","food_id","raw","food","meal","rowCount","status","data","error","result","message","rows","name"],"mappings":";;;;;;;;;;;;AAAA,IAAMA,cAAcC,QAAQC,GAAR,CAAYC,QAAZ,IAAwB,aAA5C;AACA,IAAMC,gBAAgBC,QAAQ,gBAAR,EAA0BL,WAA1B,CAAtB;AACA,IAAMM,WAAWD,QAAQ,MAAR,EAAgBD,aAAhB,CAAjB;;IAEMG,Q;;;;;;;;0FACuBC,O,EAASC,O;;;;;;;uBACjBH,SAASI,GAAT,CAAa,8CAAb,EAA6D,CAACD,OAAD,CAA7D,C;;;AAAbE,oB;;uBACaL,SAASI,GAAT,CAAa,8CAAb,EAA6D,CAACF,OAAD,CAA7D,C;;;AAAbI,oB;;oBAECD,KAAKE,Q;;;;;iDACD,EAAEC,QAAQ,GAAV,EAAeC,MAAM,EAAEC,OAAO,yBAAT,EAArB,E;;;oBACGJ,KAAKC,Q;;;;;iDACR,EAAEC,QAAQ,GAAV,EAAeC,MAAM,EAACC,OAAO,yBAAR,EAArB,E;;;;uBAEYV,SAASI,GAAT,oGAC8B,CAACF,OAAD,EAAUC,OAAV,CAD9B,C;;;AAAfQ,sB;iDAEG,EAAEH,QAAQ,GAAV,EAAeC,MAAM,EAAEG,iCAA+BP,KAAKQ,IAAL,CAAU,CAAV,EAAaC,IAA5C,YAAuDR,KAAKO,IAAL,CAAU,CAAV,EAAaC,IAAtE,EAArB,E;;;;;;;;;;;;;;;;;;;;;kBAKEb,Q","file":"MealFood.js","sourcesContent":["const environment = process.env.NODE_ENV || 'development';\nconst configuration = require('../../knexfile')[environment];\nconst database = require('knex')(configuration);\n\nclass MealFood {\n  static async addFoodToMeal(meal_id, food_id) {\n    let food = await database.raw('SELECT * FROM foods WHERE foods.id=? LIMIT 1', [food_id]);\n    let meal = await database.raw('SELECT * FROM meals WHERE meals.id=? LIMIT 1', [meal_id]);\n\n    if (!food.rowCount) {\n      return { status: 404, data: { error: 'Food could not be found' } };\n    } else if (!meal.rowCount) {\n      return { status: 404, data: {error: 'Meal could not be found' } };\n    } else {\n      let result = await database.raw(`INSERT INTO meal_foods (meal_id, food_id)\n                                       VALUES (?, ?)`, [meal_id, food_id]);\n      return { status: 201, data: { message: `Successfully added ${food.rows[0].name} to ${meal.rows[0].name }` } };\n    }\n  }\n}\n\nexport default MealFood;\n"]}